#!/usr/bin/env python

# there is some hard link trickery going on here
# hopefully this is cross-system workable
import os, cgi, cgitb, urllib2, allele

# these will be retrieved from HTTP POST once this is working okay
query = [i.split('=')[1] for i in os.getenv('QUERY_STRING').split('&')]
father = query[0]
mother = query[1]
title = ''
if len(query) > 2:
    title = urllib2.unquote(query[2])

# plot the punnett square
psquare = allele.plot(father, mother, title=title)
psquare.color(1, 1, c1='#a4c4fc')
psquare.color(2, 2, c1='#fcaba4')
psquare.color(1, 2, c1='#fcaba4', c2='#a4c4fc')
psquare.color(2, 1, c1='#fcaba4', c2='#a4c4fc')

# print the image to stdout
cgitb.enable()
print 'Content-Type: image/png'
print ''
print psquare.to_png()
