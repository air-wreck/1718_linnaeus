<!DOCTYPE html>
<html>
<head>
  <title>Linnaeus</title>
  <link rel="stylesheet" type="text/css" href="css/main.css">
  <link rel="stylesheet" type="text/css" href="css/punnett.css">

  <!-- Google fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans|Raleway|Rubik">

  <!-- menu bar for small screens -->
  <script type="text/javascript">
  window.onclick = function(event) {
    menu = document.getElementById("dropdown");
    if (event.target.matches("#dropbtn") || event.target.matches(".menu")) {
      if (menu.style.display == "none" || menu.style.display == "") {
        menu.style.display = "block";
      } else {
        menu.style.display = "none";
      }
    } else {
      menu.style.display = "none";
    }
  };
  </script>
</head>
<body>
  <div class="nav-bar">
    <ul>
      <div style="float: left;">
        <li><span><b>Linnaeus</b></span></li>
      </div>
      <div style="float: right;">
        <li><a href="home.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="pedigree.html">Pedigree</a></li>
        <li><a href="punnett.html">Punnett Square</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li><a href="faq.html">FAQs</a></li>
      </div>
      <div style="float: right;" class="narrow-menu">
        <!-- this is such a sketchy way to make a menu button -->
          <button id="dropbtn">
            <div class="menu"></div>
            <div class="menu"></div>
            <div class="menu"></div>
          </button>

          <!-- the actual dropdown menu -->
          <div id="dropdown">
            <a href="Home.html">Home</a>
            <a href="about.html">About</a>
            <a href="pedigree.html">Pedigree</a>
            <a href="punnett.html">Punnett Square</a>
            <a href="contact.html">Contact</a>
            <a href="faq.html">FAQs</a>
          </div>
      </div>
    </ul>
  </div>
  <div class="punnett-page">
    <div class="subtitle-text">
      <h1>Punnett Squares</h1>
    </div>
  </div>

  <!-- use python cgi to generate and retrieve punnett square image -->
  <script type="text/javascript">
    function load_pun() {
      var pun = document.getElementById('pun-img');
      var father = document.getElementById('father').value;
      var mother = document.getElementById('mother').value;
      var title = document.getElementById('title').value;
      /* let's not crash the server again... */
      test = RegExp('^[a-zA-Z]{2,8}$');
      if (father.length == mother.length && father.length % 2 == 0 &&
          test.test(father) && test.test(mother)) {
        pun.src = 'cgi-bin/punnett-square?father='+father+'&mother='+mother+
                  '&title='+title;
      } else {
        window.alert('Error: invalid genotypes. Make sure that genotypes are'+
                     ' the same length and at most eight characters.' +
                     ' They must be of even length and contain only letters.');
      }
    }
  
  /*
    if (father.length == mother.length && father.length % 2 == 0 &&
          test.test(father) && test.test(mother)) && check_align(mother,father) == true {
              { pun.src = 'cgi-bin/punnett-square?father='+father+'&mother='+mother+
                  '&title='+title;}
      } else {
        window.alert('Error: invalid genotypes. Make sure that genotypes are'+
                     ' the same length and at most eight characters.' +
                     ' They must be of even length and contain only letters.');
      }
    }
    function check_align(mother, father) {
      for (i = 0; i < mother.length-2; i+2) { 
           if (father.substring(i, i+2).toLowerCase() != mother.substring(i, i+2).toLowerCase() && father.substring(i, i+1).toLowerCase() != father.substring(i+1, i+2).toLowerCase())
           {
            return false;
           } 
      }
      return true;
      */
  </script>
  <div>
    Father's genotype:
    <input id="father" type="text" name="father" value="Aa"><br>
    Mother's genotype:
    <input id="mother" type="text" name="mother" value="Aa"><br>
    Title:
    <input id="title" type="text" name="title" value="example"><br>
    <button onclick="load_pun();">Solve Punnett Square</button>
  </div>
  <div>
    <img id="pun-img" src="cgi-bin/punnett-square?father=Aa&mother=Aa&title=example">
    <p>N.B. May take a long time for larger genotypes. Coloring is just for show and doesn't mean anything for now. Patience is a virtue.</p>
  </div>
</body>
</html>
